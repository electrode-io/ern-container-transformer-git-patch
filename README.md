# Git Patch Container Transformer

This transformer allows for patching any file of the Container using a patch file generated by git (through `git  diff`). It accepts one or more patch files to apply. Each patch file will be applied sequentially by the transformer using the `git apply` command.

## Inputs

- `containerPath` : Path to the Container to transform
- `patchFiles` : Array containing a list of path to git generated patch files to apply to the Container.  
Paths can be local paths (for ex `/Users/username/patch/git.patch`) or can be paths to a patch file stored in the Cauldron (for ex `cauldron://patch/git.patch`).  
As a reminder, it is possible to add a file to the Cauldron using Electrode Native [cauldron add file](https://native.electrode.io/cli-commands/cauldron-add/file) command.

## Notes

The patch will be applied from the root Container directory, so make sure to create the diff from the root of the Container.

## Usage

### With `ern transform-container` CLI command

```bash
$ ern transform-container --containerPath /patch/to/container -t git-patch -e '{"patchFiles":["/local/path/to/a.git.patch", "cauldron://path/to/another.git.patch"]}' --platform android'
```

Instead of passing the whole configuration on the command line for `--extra/-e`, it is also possible to use a file path to a json file holding the configuration, or a path to a file stored in the Cauldron. Check out the [ern transform-container](https://native.electrode.io/cli-commands/transform-container) command documentation for more info.

### With Cauldron

To automatically transform the Cauldron generated Containers of a target native application and platform, you can add a transformer entry in the Cauldron in the Container generator configuration object as follow :

```json
"transformers": [
  {
    "name": "git-patch",
    "extra": {
      "patchFiles": [
        "/local/path/to/a.git.patch",
        "cauldron://path/to/another.git.patch"
      ]
    }
  }
]
```

### Programmatically

```js
import GitPatchTransformer from 'ern-container-transformer-git-patch'
const transformer = new GitPatchTransformer()
transformer.transform(
  {
    /* Local file system path to the Container */
    containerPath: string
    /* Extra data specific to this publisher */
    extra?: {
      patchFiles: string[],
    }
  }
})
```
